create database bank345;
use bank345;
create table branch(
branch_name varchar(20),
branch_city varchar(30),
assets int,
primary key(branch_name)
);
create table bank_account(
accno int,
branch_name varchar(30),
balance int,
primary key(accno),
foreign key(branch_name) references branch(branch_name)
);

create table bankcustomer(
customer_name varchar(35),
customer_street varchar(50),
city varchar(40),
primary key(customer_name)
);

create table depositor(
customer_name varchar(20),
accno int,
primary key(customer_name,accno),
foreign key(customer_name)references bankcustomer(customer_name),
foreign key(accno) references bank_account(accno)
);

create table loan(
loan_number int,
branch_name varchar(30),
amount int,
primary key(loan_number),
foreign key(branch_name)references bank_account(branch_name)
);

insert into branch values('SBI_Chamrajpet','Bangalore',50000);
insert into branch values('SBI_ResidencyRoad','Bangalore',10000);
insert into branch values('SBI_ShivajiRoad','Bombay',200000);
insert into branch values('SBI_ParlimentRoad','Delhi',20000);
insert into branch values('SBI_Jantarmantar','Delhi',200000);
insert into bank_account values(1,'SBI_Chamrajpet',2000);
insert into bank_account values(2,'SBI_ResidencyRoad',50000);
insert into bank_account values(3,'SBI_ShivajiRoad',6000);
insert into bank_account values(4,'SBI_ParlimentRoad',9000);
insert into bank_account values(5,'SBI_Jantarmantar',8000);
insert into bank_account values(6,'SBI_ShivajiRoad',4000),
(7,'SBI_ResidencyRoad',5000),
(8,'SBI_ParlimentRoad',3000),
(9,'SBI_ResidencyRoad',5000);

insert into bankcustomer values
('Avinash','Bull_Temple_Road','Bangalore'),
('Dinesh','Bannergatta_Road','Bangalore'),
('Mohan','NationalCollege_Road','Bangalore'),
('Nikil','Akbar_Road','Delhi'),
('Ravi','Prithviraj_Road','Delhi');

insert into depositor values('Avinash',1);
insert into depositor values('Dinesh',2);
insert into depositor values('Nikil',4);
insert into depositor values('Ravi',5);
insert into depositor values('Avinash',8);
insert into depositor values('Nikil',9);
insert into depositor values('Dinesh',10);
insert into depositor values('Nikil',11);
select * from depositor;
insert into loan values(1,'SBI_Chamrajpet',1000);
insert into loan values(2,'SBI_ResidencyRoad',2000);
insert into loan values(3,'SBI_ShivajiRoad',3000);
insert into loan values(4,'SBI_ParlimentRoad',4000);
insert into loan values(5,'SBI_Jantarmantar',5000);

select branch_name,assets as assets_in_lakhs
from branch;
select d.customer_name
from depositor d,bank_account b
where b.accno=d.accno and branch_name='SBI_ResidencyRoad'
group by customer_name
having count(*)>1;
select d.customer_name
from depositor d,bank_account b
where b.accno=d.accno and branch_name='SBI_ResidencyRoad'
group by customer_name
having count(customer_name)>1;
